<!doctype html><html class="not-ready text-sm lg:text-base" style=--bg:#faf6f1 lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>OverTheWire - Bandit - Code in public</title><meta name=theme-color><meta name=description content="Computer security is something I have always been interested in, but I have never really invested much time into it. So after some poking around online, OverTheWire came up in my searches as a good capture the flag style site to learn and practice some security concepts.
The Bandit CTF is the easiest option, so I started there. Each of the 33 levels covered a different topic:
level 0 covered basic ssh access."><meta name=author content="Code in public"><link rel="preload stylesheet" as=style href=https://codeinpublic.dev/main.min.css><script defer src=https://codeinpublic.dev/highlight.min.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=preload as=image href=https://codeinpublic.dev/theme.png><link rel=icon href=https://codeinpublic.dev/favicon.ico><link rel=apple-touch-icon href=https://codeinpublic.dev/apple-touch-icon.png><meta name=generator content="Hugo 0.110.0"><meta property="og:title" content="OverTheWire - Bandit"><meta property="og:description" content="Computer security is something I have always been interested in, but I have never really invested much time into it. So after some poking around online, OverTheWire came up in my searches as a good capture the flag style site to learn and practice some security concepts.
The Bandit CTF is the easiest option, so I started there. Each of the 33 levels covered a different topic:
level 0 covered basic ssh access."><meta property="og:type" content="article"><meta property="og:url" content="https://codeinpublic.dev/posts/overthewire-bandit/"><meta property="article:section" content="posts"><meta itemprop=name content="OverTheWire - Bandit"><meta itemprop=description content="Computer security is something I have always been interested in, but I have never really invested much time into it. So after some poking around online, OverTheWire came up in my searches as a good capture the flag style site to learn and practice some security concepts.
The Bandit CTF is the easiest option, so I started there. Each of the 33 levels covered a different topic:
level 0 covered basic ssh access."><meta itemprop=wordCount content="7038"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="OverTheWire - Bandit"><meta name=twitter:description content="Computer security is something I have always been interested in, but I have never really invested much time into it. So after some poking around online, OverTheWire came up in my searches as a good capture the flag style site to learn and practice some security concepts.
The Bandit CTF is the easiest option, so I started there. Each of the 33 levels covered a different topic:
level 0 covered basic ssh access."></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[5rem] max-w-3xl px-8 lg:justify-center"><div class="relative z-50 mr-auto flex items-center"><a class="-translate-x-[1px] -translate-y-0.5 text-3xl font-bold" href=https://codeinpublic.dev/>Code in public</a><div class="btn-dark text-[0] ml-6 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 -mr-8 flex h-[5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.toggle("open")});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg=`"#faf6f1"`.replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"></div></header><main class="prose prose-neutral relative mx-auto min-h-[calc(100%-10rem)] max-w-3xl px-8 pt-16 pb-24 dark:prose-invert"><article><header class=mb-20><h1 class="!my-0 pb-2.5">OverTheWire - Bandit</h1><div class="text-sm opacity-60"></div></header><section><p>Computer security is something I have always been interested in, but I have never really invested much time into it. So after some poking around online, <a href=https://overthewire.org/>OverTheWire</a> came up in my searches as a good capture the flag style site to learn and practice some security concepts.</p><p>The Bandit CTF is the easiest option, so I started there. Each of the 33 levels covered a different topic:</p><ul><li>level 0 covered basic ssh access.</li><li>level 1 → 4 required some basic handling of files with different names and properties. This included using the <strong>file</strong> command.</li><li>level 5 → 6 cover the use of the <strong>find</strong> command to locate specific files</li><li>level 7 → 9 required some <strong>grep</strong>, <strong>sort</strong> and <strong>uniq</strong> commands to manipulate the contexts of some text data.</li><li>level 10 → 12 covered base64 and rot13 encoding and decrypting these.</li><li>level 13 deals with different kinds of compression and decompressing the provided data.</li><li>level 14 → 17 start to feel like real hacking, with data needing to be sent to services running on different ports. This needed <strong>netcat</strong>, <strong>openssl</strong> and <strong>nmap</strong>.</li><li>level 18 → 19 involve some file handling locally and remote</li><li>level 20 → 33 have less of a set theme and often require a couple of different tricks, with some being pretty challenging.</li></ul><p>Things really start to feel like 'real hacking' at around level 23!</p><p>Overall this was a lot of fun to play with and I definitely plan to play around with more of the OverTheWire games.</p><p>Details on each of the levels and write up on how I went about tackling it is provided below.
NOTE: THIS CONTAINS SPOILERS!</p><p>For each level, the login username is <em>bandit&lt;level number></em> and the host stays the same.</p><div id=outline-container-headline-1 class=outline-3><h3 id=headline-1>Level 0</h3><div id=outline-text-headline-1 class=outline-text-3><div id=outline-container-headline-2 class=outline-4><h4 id=headline-2>Level Goal</h4><div id=outline-text-headline-2 class=outline-text-4><p>We are given the following information</p><ul><li>host: bandit.labs.overthewire.org</li><li>port: 2220</li><li>username: bandit0</li><li>password: bandit0</li></ul><p>The instruction say to log into the host using SSH and the information provided</p></div></div><div id=outline-container-headline-3 class=outline-4><h4 id=headline-3>Solution</h4><div id=outline-text-headline-3 class=outline-text-4><p>This simply involved logging into the host bandit.labs.overthewire.org on port 2220 with user and password bandit0, using this command:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>ssh bandit0@bandit.labs.overthewire.org -p 2220</span></span></code></pre></div></div><p>entering the provide password <em>bandit0</em> when prompted.</p><p>This got me into the host and produced a very rewarding <a href=https://linux.die.net/man/5/motd>motd</a> with some useful information. It also had some advise around using the <a href=https://www.gnu.org/software/autogen/mktemp.html>mktemp</a> command to generate a random directory under <em>tmp</em>, which I hadn't used before but I wish I had known about.</p></div></div></div></div><div id=outline-container-headline-4 class=outline-3><h3 id=headline-4>Level 0 → 1</h3><div id=outline-text-headline-4 class=outline-text-3><div id=outline-container-headline-5 class=outline-4><h4 id=headline-5>Level Goal</h4><div id=outline-text-headline-5 class=outline-text-4><p>We are told that the password is stored in <strong>readme</strong> file located in the home directory</p></div></div><div id=outline-container-headline-6 class=outline-4><h4 id=headline-6>Solution</h4><div id=outline-text-headline-6 class=outline-text-4><p>Getting the flag involved finding the readme file and outputting its contents:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit0@bandit:~$ ls
</span></span><span style=display:flex><span>readme
</span></span><span style=display:flex><span>bandit0@bandit:~$ cat readme
</span></span><span style=display:flex><span>NH2SXQwcBdpmTEzi3bvBHMM9H66vVXjL</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-7 class=outline-3><h3 id=headline-7>Level 1 → 2</h3><div id=outline-text-headline-7 class=outline-text-3><div id=outline-container-headline-8 class=outline-4><h4 id=headline-8>Level Goal</h4><div id=outline-text-headline-8 class=outline-text-4><p>This is similar to the previous level, but the filename containing the flag is <strong>-</strong></p></div></div><div id=outline-container-headline-9 class=outline-4><h4 id=headline-9>Solution</h4><div id=outline-text-headline-9 class=outline-text-4><p>This took some researching to figure out how to handle dashed filenames:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit0@bandit:~$ ls
</span></span><span style=display:flex><span>-
</span></span><span style=display:flex><span>bandit0@bandit:~$ cat ./-
</span></span><span style=display:flex><span>rRGizSaX8Mk1RTb1CNQoXTcYZWU6lgzi</span></span></code></pre></div></div><p>Running <em>cat -</em> directly seems to have the same effect as just running <em>cat</em>, which it accepts input and then just echos it. Apparently using a <em>-</em> as filename is typically used to mean stdin/stdout.</p></div></div></div></div><div id=outline-container-headline-10 class=outline-3><h3 id=headline-10>Level 2 → 3</h3><div id=outline-text-headline-10 class=outline-text-3><div id=outline-container-headline-11 class=outline-4><h4 id=headline-11>Level Goal</h4><div id=outline-text-headline-11 class=outline-text-4><p>Like the two prior levels, the flag is contained in a file, this time the filename contains spaces.</p></div></div><div id=outline-container-headline-12 class=outline-4><h4 id=headline-12>Solution</h4><div id=outline-text-headline-12 class=outline-text-4><p>This one was easier than the prior level in that using tab completion provided correct command, which uses \ characters before each space</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit2@bandit:~$ cat spaces\ in\ this\ filename
</span></span><span style=display:flex><span>aBZ0W5EmUfAf7kHTQeOwd8bauFJ2lAiG</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-13 class=outline-3><h3 id=headline-13>Level 3 → 4</h3><div id=outline-text-headline-13 class=outline-text-3><div id=outline-container-headline-14 class=outline-4><h4 id=headline-14>Level Goal</h4><div id=outline-text-headline-14 class=outline-text-4><p>We are told that the flag is stored in the <em>inhere</em> directory.</p></div></div><div id=outline-container-headline-15 class=outline-4><h4 id=headline-15>Solution</h4><div id=outline-text-headline-15 class=outline-text-4><p>At first the file appears to be missing, but it is prefixed with a ., making it a hidden file.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit3@bandit:~$ ls
</span></span><span style=display:flex><span>inhere
</span></span><span style=display:flex><span>bandit3@bandit:~$ cd inhere/
</span></span><span style=display:flex><span>bandit3@bandit:~/inhere$ ls
</span></span><span style=display:flex><span>bandit3@bandit:~/inhere$ ls -a
</span></span><span style=display:flex><span>.  ..  .hidden
</span></span><span style=display:flex><span>bandit3@bandit:~/inhere$ cat .hidden
</span></span><span style=display:flex><span>2EW7BBsr6aMMoJ2HjW067dm8EgX26xNe</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-16 class=outline-3><h3 id=headline-16>Level 4 → 5</h3><div id=outline-text-headline-16 class=outline-text-3><div id=outline-container-headline-17 class=outline-4><h4 id=headline-17>Level Goal</h4><div id=outline-text-headline-17 class=outline-text-4><p>The clue is more cryptic than previous levels, we are told that the flag is stored in the only human-readable file in the <em>inhere</em> directory.</p></div></div><div id=outline-container-headline-18 class=outline-4><h4 id=headline-18>Solution</h4><div id=outline-text-headline-18 class=outline-text-4><p>Using the trick learned from level 1 to handle dashed files, you are able to run the <em>file</em> command with a wildcard to give you hint about which file contains the human-readable content:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit4@bandit:~/inhere$ file ./-file0*
</span></span><span style=display:flex><span>./-file00: data
</span></span><span style=display:flex><span>./-file01: data
</span></span><span style=display:flex><span>./-file02: data
</span></span><span style=display:flex><span>./-file03: data
</span></span><span style=display:flex><span>./-file04: data
</span></span><span style=display:flex><span>./-file05: data
</span></span><span style=display:flex><span>./-file06: data
</span></span><span style=display:flex><span>./-file07: ASCII text
</span></span><span style=display:flex><span>./-file08: data
</span></span><span style=display:flex><span>./-file09: Non-ISO extended-ASCII text, with no line terminators
</span></span><span style=display:flex><span>bandit4@bandit:~/inhere$ cat ./-file07
</span></span><span style=display:flex><span>lrIWWI6bB37kxfiCQZqUdOIYfr6eEeqR</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-19 class=outline-3><h3 id=headline-19>Level 5 → 6</h3><div id=outline-text-headline-19 class=outline-text-3><div id=outline-container-headline-20 class=outline-4><h4 id=headline-20>Level Goal</h4><div id=outline-text-headline-20 class=outline-text-4><p>We are told the flag file is somewhere in the <em>inhere</em> directory, and it has the follow properties:</p><ul><li>human-readable</li><li>1033 bytes in size</li><li>not executable</li></ul></div></div><div id=outline-container-headline-21 class=outline-4><h4 id=headline-21>Solution</h4><div id=outline-text-headline-21 class=outline-text-4><p>For this, I used <a href=https://man7.org/linux/man-pages/man1/find.1.html>find</a> with a test on the file size:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit5@bandit:~/inhere$ find ./ -size 1033c -printf &#39;%p %s\n&#39;
</span></span><span style=display:flex><span>./maybehere07/.file2 1033
</span></span><span style=display:flex><span>bandit5@bandit:~/inhere$ cat ./maybehere07/.file2
</span></span><span style=display:flex><span>P4L4vucdmLnm8I7Vl7jG1ApGSfjYKqJU</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-22 class=outline-3><h3 id=headline-22>Level 6 → 7</h3><div id=outline-text-headline-22 class=outline-text-3><div id=outline-container-headline-23 class=outline-4><h4 id=headline-23>Level Goal</h4><div id=outline-text-headline-23 class=outline-text-4><p>Similar to the previous level, but with a lot more files to consider. We are told that the file is somewhere on the server and has the following attributes:</p><ul><li>owned by user bandit7</li><li>owned by group bandit6</li><li>33 bytes in size</li></ul></div></div><div id=outline-container-headline-24 class=outline-4><h4 id=headline-24>Solution</h4><div id=outline-text-headline-24 class=outline-text-4><p>We use the find command to search / with the specified size and group tests. This results in two possible flag files, but checking the file details shows only one is owned by bandit7:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit6@bandit:~$ find / -size 33c -group bandit6 2&gt;/dev/null
</span></span><span style=display:flex><span>/var/lib/dpkg/info/bandit7.password
</span></span><span style=display:flex><span>/etc/bandit_pass/bandit6
</span></span><span style=display:flex><span>bandit6@bandit:~$ ls -l /var/lib/dpkg/info/bandit7.password
</span></span><span style=display:flex><span>-rw-r----- 1 bandit7 bandit6 33 Apr 23 18:04 /var/lib/dpkg/info/bandit7.password
</span></span><span style=display:flex><span>bandit6@bandit:~$ ls -l /etc/bandit_pass/bandit6
</span></span><span style=display:flex><span>-r-------- 1 bandit6 bandit6 33 Apr 23 18:04 /etc/bandit_pass/bandit6
</span></span><span style=display:flex><span>bandit6@bandit:~$ cat /var/lib/dpkg/info/bandit7.password
</span></span><span style=display:flex><span>z7WtoNQU2XfjmMtWA8u5rN4vzqu4v99S</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-25 class=outline-3><h3 id=headline-25>Level 7 → 8</h3><div id=outline-text-headline-25 class=outline-text-3><div id=outline-container-headline-26 class=outline-4><h4 id=headline-26>Level Goal</h4><div id=outline-text-headline-26 class=outline-text-4><p>For this we are given a <em>data.txt</em> file and told the flag is next to the word <em>millionth</em></p></div></div><div id=outline-container-headline-27 class=outline-4><h4 id=headline-27>Solution</h4><div id=outline-text-headline-27 class=outline-text-4><p>For this we use <a href=https://linux.die.net/man/1/grep>grep</a> to search for the line we are looking for:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit7@bandit:~$ grep millionth data.txt
</span></span><span style=display:flex><span>millionth	TESKZC0XvTetK0S9xNwm25STk5iWrBvP</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-28 class=outline-3><h3 id=headline-28>Level 8 → 9</h3><div id=outline-text-headline-28 class=outline-text-3><div id=outline-container-headline-29 class=outline-4><h4 id=headline-29>Level Goal</h4><div id=outline-text-headline-29 class=outline-text-4><p>Given <em>data.txt</em>, we have to find the one unique line in the file.</p></div></div><div id=outline-container-headline-30 class=outline-4><h4 id=headline-30>Solution</h4><div id=outline-text-headline-30 class=outline-text-4><p>We can use <a href=https://man7.org/linux/man-pages/man1/uniq.1.html>uniq</a> command to find the unique lines. Something to note, which is mentioned in the man page, is that file needs be sorted first in order to detect repeated lines.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit8@bandit:~$ cat data.txt | sort | uniq -u
</span></span><span style=display:flex><span>EN632PlfYiZbn3PhVK3XOGSlNInNE00t</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-31 class=outline-3><h3 id=headline-31>Level 9 → 10</h3><div id=outline-text-headline-31 class=outline-text-3><div id=outline-container-headline-32 class=outline-4><h4 id=headline-32>Level Goal</h4><div id=outline-text-headline-32 class=outline-text-4><p>The flag is somewhere in the <em>data.txt</em> file, which contains mostly non human-readable strings, and is preceded by several '=' characters.</p></div></div><div id=outline-container-headline-33 class=outline-4><h4 id=headline-33>Solution</h4><div id=outline-text-headline-33 class=outline-text-4><p>Using grep and some regex worked here:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>grep -a -o &#34;===\s\w*&#34; data.txt</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-34 class=outline-3><h3 id=headline-34>Level 10 → 11</h3><div id=outline-text-headline-34 class=outline-text-3><div id=outline-container-headline-35 class=outline-4><h4 id=headline-35>Level Goal</h4><div id=outline-text-headline-35 class=outline-text-4><p>The <em>data.txt</em> file is base64 encoded and contains the flag</p></div></div><div id=outline-container-headline-36 class=outline-4><h4 id=headline-36>Solution</h4><div id=outline-text-headline-36 class=outline-text-4><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit10@bandit:~$ base64 -d data.txt
</span></span><span style=display:flex><span>The password is 6zPeziLdR2RKNdNYFNb6nVCKzphlXHBM</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-37 class=outline-3><h3 id=headline-37>Level 11 → 12</h3><div id=outline-text-headline-37 class=outline-text-3><div id=outline-container-headline-38 class=outline-4><h4 id=headline-38>Level Goal</h4><div id=outline-text-headline-38 class=outline-text-4><p>The <em>data.txt</em> file is rot13 encrypted and contains the flag</p></div></div><div id=outline-container-headline-39 class=outline-4><h4 id=headline-39>Solution</h4><div id=outline-text-headline-39 class=outline-text-4><p>Using the tr command, you undo the rotation:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit11@bandit:~$ cat data.txt | tr &#39;A-Za-z&#39; &#39;N-ZA-Mn-za-m&#39;
</span></span><span style=display:flex><span>The password is JVNBBFSmZwKKOP0XbFXOoW8chDz5yVRv</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-40 class=outline-3><h3 id=headline-40>Level 12 → 13</h3><div id=outline-text-headline-40 class=outline-text-3><div id=outline-container-headline-41 class=outline-4><h4 id=headline-41>Level Goal</h4><div id=outline-text-headline-41 class=outline-text-4><p>We are provided the <em>data.txt</em> file which contains a hexdump that has been repeatedly compressed.</p></div></div><div id=outline-container-headline-42 class=outline-4><h4 id=headline-42>Solution</h4><div id=outline-text-headline-42 class=outline-text-4><p>I started by having a look what the file contains using the <strong>file</strong> command and then outputting the contents:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit12@bandit:~$ ls
</span></span><span style=display:flex><span>data.txt
</span></span><span style=display:flex><span>bandit12@bandit:~$ file data.txt
</span></span><span style=display:flex><span>data.txt: ASCII text
</span></span><span style=display:flex><span>bandit12@bandit:~$ cat data.txt
</span></span><span style=display:flex><span>00000000: 1f8b 0808 2773 4564 0203 6461 7461 322e  ....&#39;sEd..data2.
</span></span><span style=display:flex><span>00000010: 6269 6e00 0145 02ba fd42 5a68 3931 4159  bin..E...BZh91AY
</span></span><span style=display:flex><span>00000020: 2653 597b 4f96 5f00 0018 ffff fd6f e7ed  &amp;SY{O._......o..
</span></span><span style=display:flex><span>00000030: bff7 bef7 9fdb d7ca ffbf edff 8ded dfd7  ................
</span></span><span style=display:flex><span>00000040: bfe7 bbff bfdb fbff ffbf ff9f b001 3b56  ..............;V
</span></span><span style=display:flex><span>00000050: 0400 0068 0064 3400 d341 a000 0680 0699  ...h.d4..A......
</span></span><span style=display:flex><span>00000060: 0000 69a0 0000 1a00 1a0d 0034 0034 d3d4  ..i........4.4..
</span></span><span style=display:flex><span>00000070: d1a3 d464 6834 6403 d469 b422 0d00 3400  ...dh4d..i.&#34;..4.
</span></span><span style=display:flex><span>00000080: 1a68 068d 3403 4d06 8d00 0c80 00f5 0003  .h..4.M.........
</span></span><span style=display:flex><span>00000090: 4031 3119 00d0 1a68 1a34 c86d 4640 00d0  @11....h.4.mF@..
</span></span><span style=display:flex><span>000000a0: 0007 a80d 000d 00e9 a340 d034 0341 a000  .........@.4.A..
</span></span><span style=display:flex><span>000000b0: 0699 07a9 881e a0d0 da80 6834 0c43 4068  ..........h4.C@h
</span></span><span style=display:flex><span>000000c0: 6432 0340 0c80 6800 0346 8006 8000 d034  d2.@..h..F.....4
</span></span><span style=display:flex><span>000000d0: 0001 f0e1 810e 1958 b7a4 92c7 640e 421a  .......X....d.B.
</span></span><span style=display:flex><span>000000e0: a147 6142 a67e 3603 a756 3ba9 1b08 e034  .GaB.~6..V;....4
</span></span><span style=display:flex><span>000000f0: 41fd 1247 661d b380 00b7 cd8c b23e b6b2  A..Gf........&gt;..
</span></span><span style=display:flex><span>00000100: 1947 e803 0be5 6077 a542 e9ea 7810 29f0  .G....`w.B..x.).
</span></span><span style=display:flex><span>00000110: 429d e1d7 ad8b 0b78 056b e37c 06df 4917  B......x.k.|..I.
</span></span><span style=display:flex><span>00000120: 9b46 f69d 4473 80b4 edc2 ee10 04e3 3e52  .F..Ds........&gt;R
</span></span><span style=display:flex><span>00000130: dd34 2244 08cb 5e64 9314 9521 505e e767  .4&#34;D..^d...!P^.g
</span></span><span style=display:flex><span>00000140: 9021 d029 85e7 9ce2 d1ce d44f 5ec5 f6d6  .!.).......O^...
</span></span><span style=display:flex><span>00000150: d918 de31 f1f5 d149 4695 0937 d06b f046  ...1...IF..7.k.F
</span></span><span style=display:flex><span>00000160: 789d 1bd0 ca69 11eb 2c9a 3290 3d9e 0511  x....i..,.2.=...
</span></span><span style=display:flex><span>00000170: 6cad 205b edc8 c4b5 4691 379a 5978 58c3  l. [....F.7.YxX.
</span></span><span style=display:flex><span>00000180: 4846 a4a0 3ba5 a89a a794 1f93 c588 8160  HF..;..........`
</span></span><span style=display:flex><span>00000190: 016e 2504 2c74 643b 5046 4154 751c 33b1  .n%.,td;PFATu.3.
</span></span><span style=display:flex><span>000001a0: c3e5 53d8 a959 5fdc 6c12 f2bd 02f3 2d83  ..S..Y_.l.....-.
</span></span><span style=display:flex><span>000001b0: b965 3188 0d3c b097 4156 e950 9d49 64f6  .e1..&lt;..AV.P.Id.
</span></span><span style=display:flex><span>000001c0: da4a 2db5 a4ea 5365 27c0 1e79 8109 5f31  .J-...Se&#39;..y.._1
</span></span><span style=display:flex><span>000001d0: c184 46c9 74a5 f923 5ea1 6861 f058 226c  ..F.t..#^.ha.X&#34;l
</span></span><span style=display:flex><span>000001e0: 3df6 5d10 d11f d966 77c9 e488 448c 5a6f  =.]....fw...D.Zo
</span></span><span style=display:flex><span>000001f0: 2c10 410b 4280 140a 0818 8afa 0cfa 8bf7  ,.A.B...........
</span></span><span style=display:flex><span>00000200: ad34 3308 4077 6552 9849 378e 7d85 1fd8  .43.@weR.I7.}...
</span></span><span style=display:flex><span>00000210: f287 1238 7639 11e2 f1e6 483b 7548 25e2  ...8v9....H;uH%.
</span></span><span style=display:flex><span>00000220: 7de4 24ff 1a69 0b85 4b4c ebd0 1231 a512  }.$..i..KL...1..
</span></span><span style=display:flex><span>00000230: f9fb 109c e7ea d932 98fd eb76 f4f8 fa29  .......2...v...)
</span></span><span style=display:flex><span>00000240: 967c e152 9c69 c607 6207 eaef 2095 9441  .|.R.i..b... ..A
</span></span><span style=display:flex><span>00000250: a64e 9ffc 5dc9 14e1 4241 ed3e 597c 9f2e  .N..]...BA.&gt;Y|..
</span></span><span style=display:flex><span>00000260: f0c8 4502 0000                           ..E...
</span></span><span style=display:flex><span>bandit12@bandit:~$</span></span></code></pre></div></div><p>In order to restore the file from the hexdump, we use the <a href=https://linux.die.net/man/1/xxd>xxd</a> command. This produced a gzip file.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit12@bandit:/tmp/tmp.8Ys1Tohzei$ xxd -r data.txt data_file
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/tmp.8Ys1Tohzei$ file data_file
</span></span><span style=display:flex><span>data_file: gzip compressed data, was &#34;data2.bin&#34;, last modified: Sun Apr 23 18:04:23 2023, max compression, from Unix, original size modulo 2^32 581</span></span></code></pre></div></div><p>Unzipping this file resulted in another compressed file. At each iteration, I inspected the file using the <strong>file</strong> command, then renamed the file to include the correct suffix. When running the decompress commands, I used the <em>keep</em> flag so the original archive wasn't removed. This pattern of decompressing repeated for a number of different types of compression:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit12@bandit:/tmp/tmp.8Ys1Tohzei$ ls -l
</span></span><span style=display:flex><span>total 72
</span></span><span style=display:flex><span>-rw-rw-r-- 1 bandit12 bandit12   614 May 28 06:11 data1.gz
</span></span><span style=display:flex><span>-rw-rw-r-- 1 bandit12 bandit12   581 May 28 06:11 data2.bzip
</span></span><span style=display:flex><span>-rw-rw-r-- 1 bandit12 bandit12   438 May 28 06:11 data3.gz
</span></span><span style=display:flex><span>-rw-rw-r-- 1 bandit12 bandit12 20480 May 28 06:11 data4.tar
</span></span><span style=display:flex><span>-rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data5.tar
</span></span><span style=display:flex><span>-rw-r--r-- 1 bandit12 bandit12   220 Apr 23 18:04 data6.bzip
</span></span><span style=display:flex><span>-rw-r--r-- 1 bandit12 bandit12 10240 Apr 23 18:04 data7.tar
</span></span><span style=display:flex><span>-rw-r--r-- 1 bandit12 bandit12    79 Apr 23 18:04 data8.gz
</span></span><span style=display:flex><span>-rw-r--r-- 1 bandit12 bandit12    49 Apr 23 18:04 data9.txt
</span></span><span style=display:flex><span>-rw-r----- 1 bandit12 bandit12  2642 May 28 05:56 data.txt
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/tmp.8Ys1Tohzei$ cat data9.txt
</span></span><span style=display:flex><span>The password is wbWdlBxEir4CaE8LaPhauuOo6pwRmrDw
</span></span><span style=display:flex><span>bandit12@bandit:/tmp/tmp.8Ys1Tohzei$</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-43 class=outline-3><h3 id=headline-43>Level 13 → 14</h3><div id=outline-text-headline-43 class=outline-text-3><div id=outline-container-headline-44 class=outline-4><h4 id=headline-44>Level Goal</h4><div id=outline-text-headline-44 class=outline-text-4><p>For this level you are provided with an ssh private key for the bandit14 user. We are also told that the level 14 flag is stored in /etc/bandit_pass/bandit14 and can only be read by user bandit14.</p></div></div><div id=outline-container-headline-45 class=outline-4><h4 id=headline-45>Solution</h4><div id=outline-text-headline-45 class=outline-text-4><p>The ssh key file can provided to the <strong>ssh</strong> command with the <em>-i</em> flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit13@bandit:~$ ls
</span></span><span style=display:flex><span>sshkey.private
</span></span><span style=display:flex><span>bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost -p 2220</span></span></code></pre></div></div><p>Once logged in as <em>bandit14</em> we are able to access the flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
</span></span><span style=display:flex><span>fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-46 class=outline-3><h3 id=headline-46>Level 14 → 15</h3><div id=outline-text-headline-46 class=outline-text-3><div id=outline-container-headline-47 class=outline-4><h4 id=headline-47>Level Goal</h4><div id=outline-text-headline-47 class=outline-text-4><p>This level requires the flag from the previous level to be passed to a service running on port 30000.</p></div></div><div id=outline-container-headline-48 class=outline-4><h4 id=headline-48>Solution</h4><div id=outline-text-headline-48 class=outline-text-4><p>By running netcat against localhost and port 30000, you can open a connection and paste the flag from the previous level:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit14@bandit:~$ nc localhost 30000
</span></span><span style=display:flex><span>fGrHPx402xGC7U7rXKDaxiWFTOiF0ENq
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-49 class=outline-3><h3 id=headline-49>Level 15 → 16</h3><div id=outline-text-headline-49 class=outline-text-3><div id=outline-container-headline-50 class=outline-4><h4 id=headline-50>Level Goal</h4><div id=outline-text-headline-50 class=outline-text-4><p>This level requires the flag from the previous level to be passed to a service running on port 30001 using SSL</p></div></div><div id=outline-container-headline-51 class=outline-4><h4 id=headline-51>Solution</h4><div id=outline-text-headline-51 class=outline-text-4><p>An SSL connection can be established using the <strong>openssl</strong> command, which you can then paste in the flag to get the next flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit15@bandit:~$ openssl s_client -connect localhost:30001
</span></span><span style=display:flex><span>....
</span></span><span style=display:flex><span>....
</span></span><span style=display:flex><span>jN2kgmIXJ6fShzhT2avhotn4Zcka6tnt
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>JQttfApK4SeyHwDlI9SXGR50qclOAil1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>closed</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-52 class=outline-3><h3 id=headline-52>Level 16 → 17</h3><div id=outline-text-headline-52 class=outline-text-3><div id=outline-container-headline-53 class=outline-4><h4 id=headline-53>Level Goal</h4><div id=outline-text-headline-53 class=outline-text-4><p>The goal is identify an SSL service which is listening in the range of 31000 and 32000, that accepts the previous flag and return the next one.</p></div></div><div id=outline-container-headline-54 class=outline-4><h4 id=headline-54>Solution</h4><div id=outline-text-headline-54 class=outline-text-4><p>Firstly finding the possible services in the given port range was done using nmap with a port range.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit16@bandit:~$ nmap -v -p 31000-32000 localhost
</span></span><span style=display:flex><span>Starting Nmap 7.80 ( https://nmap.org ) at 2023-05-28 07:25 UTC
</span></span><span style=display:flex><span>Initiating Ping Scan at 07:25
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [2 ports]
</span></span><span style=display:flex><span>Completed Ping Scan at 07:25, 0.00s elapsed (1 total hosts)
</span></span><span style=display:flex><span>Initiating Connect Scan at 07:25
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [1001 ports]
</span></span><span style=display:flex><span>Discovered open port 31960/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31518/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31691/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31790/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31046/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Completed Connect Scan at 07:25, 0.04s elapsed (1001 total ports)
</span></span><span style=display:flex><span>Nmap scan report for localhost (127.0.0.1)
</span></span><span style=display:flex><span>Host is up (0.00013s latency).
</span></span><span style=display:flex><span>Not shown: 996 closed ports
</span></span><span style=display:flex><span>PORT      STATE SERVICE
</span></span><span style=display:flex><span>31046/tcp open  unknown
</span></span><span style=display:flex><span>31518/tcp open  unknown
</span></span><span style=display:flex><span>31691/tcp open  unknown
</span></span><span style=display:flex><span>31790/tcp open  unknown
</span></span><span style=display:flex><span>31960/tcp open  unknown</span></span></code></pre></div></div><p>Unfortunately this didn't provide much information about the services which were detected. Running this again with the <a href=https://nmap.org/book/man-version-detection.html>version detection</a> provided more useful information:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds
</span></span><span style=display:flex><span>bandit16@bandit:~$ nmap -sV -v -p 31000-32000 localhost
</span></span><span style=display:flex><span>Starting Nmap 7.80 ( https://nmap.org ) at 2023-05-28 07:27 UTC
</span></span><span style=display:flex><span>NSE: Loaded 45 scripts for scanning.
</span></span><span style=display:flex><span>Initiating Ping Scan at 07:27
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [2 ports]
</span></span><span style=display:flex><span>Completed Ping Scan at 07:27, 0.00s elapsed (1 total hosts)
</span></span><span style=display:flex><span>Initiating Connect Scan at 07:27
</span></span><span style=display:flex><span>Scanning localhost (127.0.0.1) [1001 ports]
</span></span><span style=display:flex><span>Discovered open port 31046/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31691/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31518/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31960/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Discovered open port 31790/tcp on 127.0.0.1
</span></span><span style=display:flex><span>Completed Connect Scan at 07:27, 0.02s elapsed (1001 total ports)
</span></span><span style=display:flex><span>Initiating Service scan at 07:27
</span></span><span style=display:flex><span>Scanning 5 services on localhost (127.0.0.1)
</span></span><span style=display:flex><span>Service scan Timing: About 20.00% done; ETC: 07:30 (0:02:44 remaining)
</span></span><span style=display:flex><span>Completed Service scan at 07:29, 97.74s elapsed (5 services on 1 host)
</span></span><span style=display:flex><span>NSE: Script scanning 127.0.0.1.
</span></span><span style=display:flex><span>Initiating NSE at 07:29
</span></span><span style=display:flex><span>Completed NSE at 07:29, 0.01s elapsed
</span></span><span style=display:flex><span>Initiating NSE at 07:29
</span></span><span style=display:flex><span>Completed NSE at 07:29, 0.01s elapsed
</span></span><span style=display:flex><span>Nmap scan report for localhost (127.0.0.1)
</span></span><span style=display:flex><span>Host is up (0.00010s latency).
</span></span><span style=display:flex><span>Not shown: 996 closed ports
</span></span><span style=display:flex><span>PORT      STATE SERVICE     VERSION
</span></span><span style=display:flex><span>31046/tcp open  echo
</span></span><span style=display:flex><span>31518/tcp open  ssl/echo
</span></span><span style=display:flex><span>31691/tcp open  echo
</span></span><span style=display:flex><span>31790/tcp open  ssl/unknown
</span></span><span style=display:flex><span>31960/tcp open  echo
</span></span><span style=display:flex><span>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style=display:flex><span>SF-Port31790-TCP:V=7.80%T=SSL%I=7%D=5/28%Time=6473026D%P=x86_64-pc-linux-g
</span></span><span style=display:flex><span>SF:nu%r(GenericLines,31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
</span></span><span style=display:flex><span>SF:rrent\x20password\n&#34;)%r(GetRequest,31,&#34;Wrong!\x20Please\x20enter\x20the
</span></span><span style=display:flex><span>SF:\x20correct\x20current\x20password\n&#34;)%r(HTTPOptions,31,&#34;Wrong!\x20Plea
</span></span><span style=display:flex><span>SF:se\x20enter\x20the\x20correct\x20current\x20password\n&#34;)%r(RTSPRequest,
</span></span><span style=display:flex><span>SF:31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
</span></span><span style=display:flex><span>SF:n&#34;)%r(Help,31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
</span></span><span style=display:flex><span>SF:20password\n&#34;)%r(SSLSessionReq,31,&#34;Wrong!\x20Please\x20enter\x20the\x20
</span></span><span style=display:flex><span>SF:correct\x20current\x20password\n&#34;)%r(TerminalServerCookie,31,&#34;Wrong!\x2
</span></span><span style=display:flex><span>SF:0Please\x20enter\x20the\x20correct\x20current\x20password\n&#34;)%r(TLSSess
</span></span><span style=display:flex><span>SF:ionReq,31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20pa
</span></span><span style=display:flex><span>SF:ssword\n&#34;)%r(Kerberos,31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x
</span></span><span style=display:flex><span>SF:20current\x20password\n&#34;)%r(FourOhFourRequest,31,&#34;Wrong!\x20Please\x20e
</span></span><span style=display:flex><span>SF:nter\x20the\x20correct\x20current\x20password\n&#34;)%r(LPDString,31,&#34;Wrong
</span></span><span style=display:flex><span>SF:!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n&#34;)%r(LDA
</span></span><span style=display:flex><span>SF:PSearchReq,31,&#34;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
</span></span><span style=display:flex><span>SF:20password\n&#34;)%r(SIPOptions,31,&#34;Wrong!\x20Please\x20enter\x20the\x20cor
</span></span><span style=display:flex><span>SF:rect\x20current\x20password\n&#34;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style=display:flex><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style=display:flex><span>Nmap done: 1 IP address (1 host up) scanned in 98.16 seconds
</span></span><span style=display:flex><span>bandit16@bandit:~$</span></span></code></pre></div></div><p>This output shows 2 ssl services, with an unknown service on port 31790.
We can connect to the this service using the following command:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ openssl s_client -connect localhost:31790
</span></span><span style=display:flex><span>    │       │        │        │       │
</span></span><span style=display:flex><span>    │       │        │        │       └ Target port number to connect to.
</span></span><span style=display:flex><span>    │       │        │        └ Target host to connect to.
</span></span><span style=display:flex><span>    │       │        └ Specifies that we are connecting to another host.
</span></span><span style=display:flex><span>    │       └ Use the SSL client. See https://linux.die.net/man/1/s_client.
</span></span><span style=display:flex><span>    └─ openssl command line tool. See https://linux.die.net/man/1/openssl.</span></span></code></pre></div></div><p>After connecting using <strong>openssl</strong>, we could provide the previous flag and get the next flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit16@bandit:~$ openssl s_client -connect localhost:31790
</span></span><span style=display:flex><span>CONNECTED(00000003)
</span></span><span style=display:flex><span>Can&#39;t use SSL_get_servername
</span></span><span style=display:flex><span>depth=0 CN = localhost
</span></span><span style=display:flex><span>verify error:num=18:self-signed certificate
</span></span><span style=display:flex><span>verify return:1
</span></span><span style=display:flex><span>depth=0 CN = localhost
</span></span><span style=display:flex><span>verify error:num=10:certificate has expired
</span></span><span style=display:flex><span>notAfter=May 25 14:09:04 2023 GMT
</span></span><span style=display:flex><span>verify return:1
</span></span><span style=display:flex><span>depth=0 CN = localhost
</span></span><span style=display:flex><span>notAfter=May 25 14:09:04 2023 GMT
</span></span><span style=display:flex><span>verify return:1
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Certificate chain
</span></span><span style=display:flex><span> 0 s:CN = localhost
</span></span><span style=display:flex><span>   i:CN = localhost
</span></span><span style=display:flex><span>   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA1
</span></span><span style=display:flex><span>   v:NotBefore: May 25 14:08:04 2023 GMT; NotAfter: May 25 14:09:04 2023 GMT
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Server certificate
</span></span><span style=display:flex><span>-----BEGIN CERTIFICATE-----
</span></span><span style=display:flex><span>MIIDCzCCAfOgAwIBAgIEYAl7PTANBgkqhkiG9w0BAQUFADAUMRIwEAYDVQQDDAls
</span></span><span style=display:flex><span>b2NhbGhvc3QwHhcNMjMwNTI1MTQwODA0WhcNMjMwNTI1MTQwOTA0WjAUMRIwEAYD
</span></span><span style=display:flex><span>VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDg
</span></span><span style=display:flex><span>IGUha7KV/lFMUBBJCEtUxxDGXrpOi30oN8DoRGhyyzhy9z8idZTdKqQjfUeVg1ou
</span></span><span style=display:flex><span>kVkUTMeMdAAEiW6ulI46JqDybZkBXEN39LXTHwi6iMWkrgxM/eErfHgb6T5juKlA
</span></span><span style=display:flex><span>CXDNuM1E3L1gmEKhu3estoCHVU811JgwVbX4GR3wZkm17TERALNEoLIRxONZqyVd
</span></span><span style=display:flex><span>+KGENHCXDtZCYCp03ygl14Z24Qd7CfiwLTuaGj962Zx68/XiwVgfX4sDbPLu5/Yf
</span></span><span style=display:flex><span>rqymsh29cKSKqDvdv/ZqBukNzDLnpkmSiv9xJJLT2Yy6wZk/ZN5k526MJ76FUAy3
</span></span><span style=display:flex><span>bTi/ve4wVtWlxIYTGR0BAgMBAAGjZTBjMBQGA1UdEQQNMAuCCWxvY2FsaG9zdDBL
</span></span><span style=display:flex><span>BglghkgBhvhCAQ0EPhY8QXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTmNhdC4g
</span></span><span style=display:flex><span>U2VlIGh0dHBzOi8vbm1hcC5vcmcvbmNhdC8uMA0GCSqGSIb3DQEBBQUAA4IBAQAV
</span></span><span style=display:flex><span>4ayu1YssdPlnSE/kBSxH1XJSM+30PxPUamo9AkmJ23v/c/rlXeAbM1rPHe2gXtro
</span></span><span style=display:flex><span>jxOtkBY/cYK4okPtxVpfpIAmXxE18UGvv7UtmE1J4wLrAliFDAHWRB5rUYRHtbPL
</span></span><span style=display:flex><span>v7bk7gb+/7r2R6hhr4laq3013vVpfTN/VBzL3gSIHTm4IuoukrKg0i320v8pqJdA
</span></span><span style=display:flex><span>AmH3BWouNr0Wxd70Y2fo1Wezq6pzBfXnBDkhLbIn14DFMkibu87nKCEsYkRdsVkH
</span></span><span style=display:flex><span>fxLimiO+gNOXeUVDKZ6mQN3AMgADiM37AXijqDXq+C3bDP80iBkNq3viYCVFwSeA
</span></span><span style=display:flex><span>kAEXLmJFhK6G4vlqwWmu
</span></span><span style=display:flex><span>-----END CERTIFICATE-----
</span></span><span style=display:flex><span>subject=CN = localhost
</span></span><span style=display:flex><span>issuer=CN = localhost
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>No client certificate CA names sent
</span></span><span style=display:flex><span>Peer signing digest: SHA256
</span></span><span style=display:flex><span>Peer signature type: RSA-PSS
</span></span><span style=display:flex><span>Server Temp Key: X25519, 253 bits
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>SSL handshake has read 1339 bytes and written 373 bytes
</span></span><span style=display:flex><span>Verification error: certificate has expired
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
</span></span><span style=display:flex><span>Server public key is 2048 bit
</span></span><span style=display:flex><span>Secure Renegotiation IS NOT supported
</span></span><span style=display:flex><span>Compression: NONE
</span></span><span style=display:flex><span>Expansion: NONE
</span></span><span style=display:flex><span>No ALPN negotiated
</span></span><span style=display:flex><span>Early data was not sent
</span></span><span style=display:flex><span>Verify return code: 10 (certificate has expired)
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Post-Handshake New Session Ticket arrived:
</span></span><span style=display:flex><span>SSL-Session:
</span></span><span style=display:flex><span>    Protocol  : TLSv1.3
</span></span><span style=display:flex><span>    Cipher    : TLS_AES_256_GCM_SHA384
</span></span><span style=display:flex><span>    Session-ID: BCA1BB621BECC6981FE04CF24AA1D9D9648A7104108DEB850E683D47250619F8
</span></span><span style=display:flex><span>    Session-ID-ctx:
</span></span><span style=display:flex><span>    Resumption PSK: CE509805D592031706729D7A35655AC6A3AB86F346FB0871E511013B3E3428C6BD18772DA0495312FCEB3B690E6308DE
</span></span><span style=display:flex><span>    PSK identity: None
</span></span><span style=display:flex><span>    PSK identity hint: None
</span></span><span style=display:flex><span>    SRP username: None
</span></span><span style=display:flex><span>    TLS session ticket lifetime hint: 7200 (seconds)
</span></span><span style=display:flex><span>    TLS session ticket:
</span></span><span style=display:flex><span>    0000 - 2c 0e fb 39 16 33 06 8c-99 5a 89 da df d9 95 0c   ,..9.3...Z......
</span></span><span style=display:flex><span>    0010 - 8a 5e a3 fe 25 89 8e 07-0d 84 32 48 0e ff 40 b0   .^..%.....2H..@.
</span></span><span style=display:flex><span>    0020 - 31 b0 9e f6 44 1b 55 61-a0 e8 be 06 fe c4 23 d0   1...D.Ua......#.
</span></span><span style=display:flex><span>    0030 - 4a f1 96 f7 34 69 ed eb-dd 2f 1d 5e c6 98 72 8d   J...4i.../.^..r.
</span></span><span style=display:flex><span>    0040 - e9 a1 33 be 82 06 e9 0f-a5 e6 bb 8a 9c f1 03 14   ..3.............
</span></span><span style=display:flex><span>    0050 - b5 d5 6b 8c 23 fc fb dd-15 6b 45 54 09 44 d8 94   ..k.#....kET.D..
</span></span><span style=display:flex><span>    0060 - 58 48 23 a1 f7 21 44 dc-09 5d 4b d2 91 a0 f6 8d   XH#..!D..]K.....
</span></span><span style=display:flex><span>    0070 - ff f8 5c 93 67 b9 7e b7-aa 4d 0a 76 60 31 1d 3a   ..\.g.~..M.v`1.:
</span></span><span style=display:flex><span>    0080 - fc fd 8d 5c 5f fa ce 66-52 80 3c 59 ba 3c 57 dd   ...\_..fR.&lt;Y.&lt;W.
</span></span><span style=display:flex><span>    0090 - 15 40 4c 64 1a 29 19 3a-cd 6b 51 a7 69 73 79 0c   .@Ld.).:.kQ.isy.
</span></span><span style=display:flex><span>    00a0 - e9 95 01 fd 14 1f b4 fe-a5 eb 1a b9 3c b0 6b 1e   ............&lt;.k.
</span></span><span style=display:flex><span>    00b0 - e5 63 e8 26 e2 ee b6 2d-aa f5 01 35 b8 cc 6a 9f   .c.&amp;...-...5..j.
</span></span><span style=display:flex><span>    00c0 - 67 5f 5d 96 cc ce 04 40-24 7a f5 26 1b df d6 60   g_]....@$z.&amp;...`
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Start Time: 1685259676
</span></span><span style=display:flex><span>    Timeout   : 7200 (sec)
</span></span><span style=display:flex><span>    Verify return code: 10 (certificate has expired)
</span></span><span style=display:flex><span>    Extended master secret: no
</span></span><span style=display:flex><span>    Max Early Data: 0
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>read R BLOCK
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>Post-Handshake New Session Ticket arrived:
</span></span><span style=display:flex><span>SSL-Session:
</span></span><span style=display:flex><span>    Protocol  : TLSv1.3
</span></span><span style=display:flex><span>    Cipher    : TLS_AES_256_GCM_SHA384
</span></span><span style=display:flex><span>    Session-ID: 621BA60A1CC362E5DD097E3E5826392894228D6A7502C557EEADCDAA31ABE237
</span></span><span style=display:flex><span>    Session-ID-ctx:
</span></span><span style=display:flex><span>    Resumption PSK: D8710361E5ED097D6EEB5B60E41D2C38F1C0F35A5381ECDD5E7A90F8D7C0DDA5BE8FF97819C9A617967DF719028C5DDD
</span></span><span style=display:flex><span>    PSK identity: None
</span></span><span style=display:flex><span>    PSK identity hint: None
</span></span><span style=display:flex><span>    SRP username: None
</span></span><span style=display:flex><span>    TLS session ticket lifetime hint: 7200 (seconds)
</span></span><span style=display:flex><span>    TLS session ticket:
</span></span><span style=display:flex><span>    0000 - 2c 0e fb 39 16 33 06 8c-99 5a 89 da df d9 95 0c   ,..9.3...Z......
</span></span><span style=display:flex><span>    0010 - be 66 ed a2 b6 62 2b 1a-24 d1 cc c3 68 b4 b8 f5   .f...b+.$...h...
</span></span><span style=display:flex><span>    0020 - 23 bb 5c 59 dc 5a 9e 5e-28 0b f1 6c fe 69 88 a1   #.\Y.Z.^(..l.i..
</span></span><span style=display:flex><span>    0030 - fc 52 2d 38 9f 5f f3 5b-f2 b8 aa 45 ce 31 77 00   .R-8._.[...E.1w.
</span></span><span style=display:flex><span>    0040 - 23 54 02 ec 95 e5 11 06-8a 62 ce 6f 87 85 ba 4b   #T.......b.o...K
</span></span><span style=display:flex><span>    0050 - 9f b8 a0 fc 7f d3 6a 9b-9c 3f 95 15 b0 e2 db d9   ......j..?......
</span></span><span style=display:flex><span>    0060 - 89 19 d2 9d a8 c9 fa 31-cd 87 72 33 a9 4b 1a 32   .......1..r3.K.2
</span></span><span style=display:flex><span>    0070 - 7a 9d b7 e0 65 e3 7b 11-7c 25 44 4f e1 fd 24 ef   z...e.{.|%DO..$.
</span></span><span style=display:flex><span>    0080 - fd 73 a1 c4 2f d8 94 c9-68 d3 c8 17 51 3d 42 ce   .s../...h...Q=B.
</span></span><span style=display:flex><span>    0090 - d0 0a 09 3d f8 48 76 6a-4d 4c 2d 27 fb b4 19 5a   ...=.HvjML-&#39;...Z
</span></span><span style=display:flex><span>    00a0 - 66 49 23 ae c6 0c 59 4a-50 64 aa 01 a9 21 0a c9   fI#...YJPd...!..
</span></span><span style=display:flex><span>    00b0 - 36 85 eb 35 1e 3d 67 0d-77 05 be 80 63 a7 05 bd   6..5.=g.w...c...
</span></span><span style=display:flex><span>    00c0 - a0 a1 64 c3 4e 6d 37 48-6e c5 96 3b 9c f0 13 ca   ..d.Nm7Hn..;....
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Start Time: 1685259676
</span></span><span style=display:flex><span>    Timeout   : 7200 (sec)
</span></span><span style=display:flex><span>    Verify return code: 10 (certificate has expired)
</span></span><span style=display:flex><span>    Extended master secret: no
</span></span><span style=display:flex><span>    Max Early Data: 0
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>read R BLOCK
</span></span><span style=display:flex><span>JQttfApK4SeyHwDlI9SXGR50qclOAil1
</span></span><span style=display:flex><span>Correct!
</span></span><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
</span></span><span style=display:flex><span>imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
</span></span><span style=display:flex><span>Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
</span></span><span style=display:flex><span>DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
</span></span><span style=display:flex><span>JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
</span></span><span style=display:flex><span>x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
</span></span><span style=display:flex><span>KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
</span></span><span style=display:flex><span>J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
</span></span><span style=display:flex><span>d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
</span></span><span style=display:flex><span>YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
</span></span><span style=display:flex><span>vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
</span></span><span style=display:flex><span>+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
</span></span><span style=display:flex><span>8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
</span></span><span style=display:flex><span>SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
</span></span><span style=display:flex><span>HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
</span></span><span style=display:flex><span>SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
</span></span><span style=display:flex><span>R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
</span></span><span style=display:flex><span>Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
</span></span><span style=display:flex><span>R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
</span></span><span style=display:flex><span>L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
</span></span><span style=display:flex><span>blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
</span></span><span style=display:flex><span>YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
</span></span><span style=display:flex><span>77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
</span></span><span style=display:flex><span>dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
</span></span><span style=display:flex><span>vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>closed</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-55 class=outline-3><h3 id=headline-55>Level 17 → 18</h3><div id=outline-text-headline-55 class=outline-text-3><div id=outline-container-headline-56 class=outline-4><h4 id=headline-56>Level Goal</h4><div id=outline-text-headline-56 class=outline-text-4><p>The flag from the previos level was provided in the form of the private sshkey, which needed to be used to login for the <em>bandit17</em> user.</p><p>We first needed to change the permissions on the keyfile using <strong>chmod</strong> with a permission of <em>600</em>.</p><p>The goal for this level was to find the single changed entry between <em>password.new</em> and <em>password.old</em> files.</p></div></div><div id=outline-container-headline-57 class=outline-4><h4 id=headline-57>Solution</h4><div id=outline-text-headline-57 class=outline-text-4><p>Using the <strong>diff</strong> command, you can see which entries have changed:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit17@bandit:~$ diff passwords.new passwords.old
</span></span><span style=display:flex><span>42c42
</span></span><span style=display:flex><span>&lt; hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>&gt; glZreTEH1V3cGKL6g4conYqZqaEj0mte
</span></span><span style=display:flex><span>bandit17@bandit:~$ grep hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg passwords.new
</span></span><span style=display:flex><span>hga5tuuCLF6fFzUpnagiMN8ssu9LFrdg
</span></span><span style=display:flex><span>bandit17@bandit:~$</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-58 class=outline-3><h3 id=headline-58>Level 18 → 19</h3><div id=outline-text-headline-58 class=outline-text-3><div id=outline-container-headline-59 class=outline-4><h4 id=headline-59>Level Goal</h4><div id=outline-text-headline-59 class=outline-text-4><p>When logging in with <em>bandit18</em>, the ssh session is closed. The hint provided is that someone has modified the <em>.bashrc</em> to cause this to happen.</p><p>We are also told that the flag is stored in the <em>readme</em> file.</p></div></div><div id=outline-container-headline-60 class=outline-4><h4 id=headline-60>Solution</h4><div id=outline-text-headline-60 class=outline-text-4><p>We can retrieve the contents of the file by adding the remote command to the <strong>ssh</strong> command:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level16$ ssh bandit18@bandit.labs.overthewire.org -p 2220 &#39;cat readme&#39;
</span></span><span style=display:flex><span>                         _                     _ _ _
</span></span><span style=display:flex><span>                        | |__   __ _ _ __   __| (_) |_
</span></span><span style=display:flex><span>                        | &#39;_ \ / _` | &#39;_ \ / _` | | __|
</span></span><span style=display:flex><span>                        | |_) | (_| | | | | (_| | | |_
</span></span><span style=display:flex><span>                        |_.__/ \__,_|_| |_|\__,_|_|\__|
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                      This is an OverTheWire game server.
</span></span><span style=display:flex><span>            More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit18@bandit.labs.overthewire.org&#39;s password:
</span></span><span style=display:flex><span>awhqfNnAbc1naukrpqDYcF95h7HoMTrC</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-61 class=outline-3><h3 id=headline-61>Level 19 → 20</h3><div id=outline-text-headline-61 class=outline-text-3><div id=outline-container-headline-62 class=outline-4><h4 id=headline-62>Level Goal</h4><div id=outline-text-headline-62 class=outline-text-4><p>We are provided with a binary, <em>bandit20-do</em>, which is apparently a setuid binary. This needs to be used to access the flag in /etc/bandit_pass.</p></div></div><div id=outline-container-headline-63 class=outline-4><h4 id=headline-63>Solution</h4><div id=outline-text-headline-63 class=outline-text-4><p>Running the <em>bandit20-do</em> command provides a usage message and seems to execute the given command as the bandit20 user:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do
</span></span><span style=display:flex><span>Run a command as another user.
</span></span><span style=display:flex><span>  Example: ./bandit20-do id
</span></span><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do id
</span></span><span style=display:flex><span>uid=11019(bandit19) gid=11019(bandit19) euid=11020(bandit20) groups=11019(bandit19)
</span></span><span style=display:flex><span>bandit19@bandit:~$ whoami
</span></span><span style=display:flex><span>bandit19
</span></span><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do whoami
</span></span><span style=display:flex><span>bandit20</span></span></code></pre></div></div><p>Using this binary, we can cat the contents of the bandit20 password file:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
</span></span><span style=display:flex><span>VxCazJaVykI6W36BkBU0mJTCM8rR95XT</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-64 class=outline-3><h3 id=headline-64>Level 20 → 21</h3><div id=outline-text-headline-64 class=outline-text-3><div id=outline-container-headline-65 class=outline-4><h4 id=headline-65>Level Goal</h4><div id=outline-text-headline-65 class=outline-text-4><p>There is a setuid binary in the home directory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p><p>There is a hint to try connecting to our own network daemon to see if it works as we expect.</p></div></div><div id=outline-container-headline-66 class=outline-4><h4 id=headline-66>Solution</h4><div id=outline-text-headline-66 class=outline-text-4><p>Because we needed 2 processes running for this, I created two screen sessions.</p><p>Based on the hint provided, I then setup a netcat process to listen on port 36969, using <strong>nc</strong> with -k to keep the connection alive and -l to listen for incoming connections:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit20@bandit:/tmp/tmp.p4g7AJfF4E$ nc -k -l 36969</span></span></code></pre></div></div><p>In the other screen session, I then connected to the listening netcat process on port 36969. To test that it was behaving as expected, I sent the message "sent from client" from the client netcat process I had just started and then replied with "sent from the server" from the listing netcat process spawned from the step above.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit20@bandit:/tmp/tmp.p4g7AJfF4E$ nc -k -l 36969
</span></span><span style=display:flex><span>sent from client
</span></span><span style=display:flex><span>sent from server
</span></span><span style=display:flex><span>^C</span></span></code></pre></div></div><p>After seeing this work as expected, we can replace the connecting netcat with the provided binary.</p><p>With the netcat process listening on 36969, we execute the <strong>suconnect</strong> to call the same port. Then on the listening side, we paste in the flag from prior level. This sent the old flag to the suconnect, which then replied with the next flag:</p><p>The first flag was pasted in by hand, the second was the reply received:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit20@bandit:~$ nc -k -l 36969
</span></span><span style=display:flex><span>VxCazJaVykI6W36BkBU0mJTCM8rR95XT
</span></span><span style=display:flex><span>NvEJF7oVjkddltPSrdKEFOllh9V1IBcq
</span></span><span style=display:flex><span>^C</span></span></code></pre></div></div><p>The output from the suconnect process shows old password was received and next one was sent:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit20@bandit:~$ ./suconnect 36969
</span></span><span style=display:flex><span>Read: VxCazJaVykI6W36BkBU0mJTCM8rR95XT
</span></span><span style=display:flex><span>Password matches, sending next password</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-67 class=outline-3><h3 id=headline-67>Level 21 → 22</h3><div id=outline-text-headline-67 class=outline-text-3><div id=outline-container-headline-68 class=outline-4><h4 id=headline-68>Level Goal</h4><div id=outline-text-headline-68 class=outline-text-4><p>We are told that a cron job is running periodically and we need to see which command is being executed. The configuration is found in <em>etc/cron.d</em>.</p></div></div><div id=outline-container-headline-69 class=outline-4><h4 id=headline-69>Solution</h4><div id=outline-text-headline-69 class=outline-text-4><p>We can check which jobs exist, then what script they are calling and finally output the script. In this case the scrip is periodically writing the contents of the password to a temp file, which we then output:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit21@bandit:~$ ls -alt /etc/cron.d
</span></span><span style=display:flex><span>total 56
</span></span><span style=display:flex><span>drwxr-xr-x   2 root root  4096 Apr 23 18:05 .
</span></span><span style=display:flex><span>-rwx------   1 root root    52 Apr 23 18:05 otw-tmp-dir
</span></span><span style=display:flex><span>drwxr-xr-x 108 root root 12288 Apr 23 18:05 ..
</span></span><span style=display:flex><span>-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit25_root
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit24
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   122 Apr 23 18:04 cronjob_bandit23
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   120 Apr 23 18:04 cronjob_bandit22
</span></span><span style=display:flex><span>-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit17_root
</span></span><span style=display:flex><span>-rw-r--r--   1 root root    62 Apr 23 18:04 cronjob_bandit15_root
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   102 Mar 23  2022 .placeholder
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   201 Jan  8  2022 e2scrub_all
</span></span><span style=display:flex><span>-rw-r--r--   1 root root   396 Feb  2  2021 sysstat
</span></span><span style=display:flex><span>bandit21@bandit:~$ cat /etc/cron.d/cronjob_bandit22
</span></span><span style=display:flex><span>@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</span></span><span style=display:flex><span>* * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</span></span><span style=display:flex><span>bandit21@bandit:~$ ls -alt /usr/bin/cronjob_bandit22.sh
</span></span><span style=display:flex><span>-rwxr-x--- 1 bandit22 bandit21 130 Apr 23 18:04 /usr/bin/cronjob_bandit22.sh
</span></span><span style=display:flex><span>bandit21@bandit:~$ cat /usr/bin/cronjob_bandit22.sh
</span></span><span style=display:flex><span>#!/bin/bash
</span></span><span style=display:flex><span>chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span></span><span style=display:flex><span>cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span></span><span style=display:flex><span>bandit21@bandit:~$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</span></span><span style=display:flex><span>WdDozAdTM2z9DiFEQ2mGlwngMfj4EZff
</span></span><span style=display:flex><span>bandit21@bandit:~$</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-70 class=outline-3><h3 id=headline-70>Level 22 → 23</h3><div id=outline-text-headline-70 class=outline-text-3><div id=outline-container-headline-71 class=outline-4><h4 id=headline-71>Level Goal</h4><div id=outline-text-headline-71 class=outline-text-4><p>We are again told that a cron job is running periodically and we need to see which command is being executed. The configuration is found in <em>etc/cron.d</em>.</p><p>This time we are given a hint that a custom script is run.</p></div></div><div id=outline-container-headline-72 class=outline-4><h4 id=headline-72>Solution</h4><div id=outline-text-headline-72 class=outline-text-4><p>This time we check the cron configuration and find that custom script is being run:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit22@bandit:~$ ls /etc/cron.d/
</span></span><span style=display:flex><span>cronjob_bandit15_root  cronjob_bandit22  cronjob_bandit24       e2scrub_all  sysstat
</span></span><span style=display:flex><span>cronjob_bandit17_root  cronjob_bandit23  cronjob_bandit25_root  otw-tmp-dir
</span></span><span style=display:flex><span>bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23
</span></span><span style=display:flex><span>@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
</span></span><span style=display:flex><span>* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null</span></span></code></pre></div></div><p>The contents of this script are:</p><div class="src src-bash"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>myname<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>whoami<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>mytarget<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo I am user $myname | md5sum | cut -d <span style=color:#e6db74>&#39; &#39;</span> -f 1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Copying passwordfile /etc/bandit_pass/</span>$myname<span style=color:#e6db74> to /tmp/</span>$mytarget<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget</span></span></code></pre></div></div><p>From this, we can determine what <em>mytarget</em> would be for the <em>bandit23</em> user:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit22@bandit:~$ echo I am user bandit23 | md5sum | cut -d &#39; &#39; -f 1
</span></span><span style=display:flex><span>8ca319486bfbbc3663ea0fbe81326349
</span></span><span style=display:flex><span>bandit22@bandit:~$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
</span></span><span style=display:flex><span>QYw0Y2aiA672PsMmh9puTQuhoz8SyR2G</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-73 class=outline-3><h3 id=headline-73>Level 23 → 24</h3><div id=outline-text-headline-73 class=outline-text-3><div id=outline-container-headline-74 class=outline-4><h4 id=headline-74>Level Goal</h4><div id=outline-text-headline-74 class=outline-text-4><p>Similar to the previous 2 levels, were are told that a program is running automatically at regular intervals from cron, the time-based job scheduler. Look in <em>etc/cron.d</em> for the configuration and see what command is being executed.</p><p>We are provided a hint that we are going to need to write our own script for this one</p></div></div><div id=outline-container-headline-75 class=outline-4><h4 id=headline-75>Solution</h4><div id=outline-text-headline-75 class=outline-text-4><p>Based on the solution from the previous levels, we can see that the script being run by the cron is <em>/usr/bin/cronjob_bandit24.sh</em></p><div class="src src-bash"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>myname<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>whoami<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd /var/spool/$myname/foo <span style=color:#f92672>||</span> exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Executing and deleting all scripts in /var/spool/</span>$myname<span style=color:#e6db74>/foo:&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in * .*;
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$i<span style=color:#e6db74>&#34;</span> !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;.&#34;</span> -a <span style=color:#e6db74>&#34;</span>$i<span style=color:#e6db74>&#34;</span> !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;..&#34;</span> <span style=color:#f92672>]</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;Handling </span>$i<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        owner<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>stat --format <span style=color:#e6db74>&#34;%U&#34;</span> ./$i<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>owner<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bandit23&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>            timeout -s <span style=color:#ae81ff>9</span> <span style=color:#ae81ff>60</span> ./$i
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>        rm -rf ./$i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span></span></span></code></pre></div></div><p>This script seems to run all of the script contained in the //var/spool/bandit24/foo directory. Each script needs to be owned by bandit23 and will timeout after 60 seconds. They are then all deleted.</p><p>We also know that the flag we are looking for is stored at <em><em>etc/bandit_pass/bandit24</em></em>, so our script could follow the same pattern as the previous level and cat the password to a tmp file.</p><p>As a proof of concept, I created a simple script to output to a tmp file:</p><div class="src src-bash"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;It ran&#34;</span> &gt; /tmp/tmp.8mlHq5Huee.out</span></span></code></pre></div></div><p>which worked as expected:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit23@bandit:/tmp/tmp.8mlHq5Huee$ cat /tmp/tmp.8mlHq5Huee.out
</span></span><span style=display:flex><span>It ran</span></span></code></pre></div></div><p>Knowing that the cron and script worked as expected, it was updated to the follow:</p><div class="src src-bash"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Running..&#34;</span> &gt; /tmp/tmp.8mlHq5Huee.out
</span></span><span style=display:flex><span>cat /etc/bandit_pass/bandit24 &gt;&gt; /tmp/tmp.8mlHq5Huee.out
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Done&#34;</span> &gt;&gt; /tmp/tmp.8mlHq5Huee.out</span></span></code></pre></div></div><p>This resulted in the flag being captured in our output file:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit23@bandit:/tmp/tmp.8mlHq5Huee$ cat /tmp/tmp.8mlHq5Huee.out
</span></span><span style=display:flex><span>Running..
</span></span><span style=display:flex><span>VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar
</span></span><span style=display:flex><span>Done</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-76 class=outline-3><h3 id=headline-76>Level 24 → 25</h3><div id=outline-text-headline-76 class=outline-text-3><div id=outline-container-headline-77 class=outline-4><h4 id=headline-77>Level Goal</h4><div id=outline-text-headline-77 class=outline-text-4><p>A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.
You do not need to create new connections each time</p></div></div><div id=outline-container-headline-78 class=outline-4><h4 id=headline-78>Solution</h4><div id=outline-text-headline-78 class=outline-text-4><p>Poking around a bit, I found that you can cat a list of password and pin number combinations to the port using netcat.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit24@bandit:/tmp/tmp.aQwi1Ti4zL$ cat list.txt | nc localhost 30002 | tee output.txt
</span></span><span style=display:flex><span>I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
</span></span><span style=display:flex><span>Wrong! Please enter the correct pincode. Try again.
</span></span><span style=display:flex><span>Wrong! Please enter the correct pincode. Try again.
</span></span><span style=display:flex><span>^C</span></span></code></pre></div></div><p>This gives us a starting point, but we now need to populate the list with all 10000 pin code combinations. This was a bit tricky an required the <a href=https://linux.die.net/man/1/seq>seq</a> command in order to left pad the pins with 0's.</p><p>The following script generated the full password list:</p><div class="src src-bash"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#66d9ef>$(</span>seq -f <span style=color:#e6db74>&#34;%04g&#34;</span> <span style=color:#ae81ff>0</span> 10000<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  echo VAfGXJ1PBSsPSnvsjI8p759leLZ9GGar $i &gt;&gt; list.txt
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span></span></span></code></pre></div></div><p>When attempting to cat all of the 9999 pin codes, it seemed to repeatedly hit an issue at around 6300, where the we didn't get anymore output. Because of this I tried doing it in two batches of 5000:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit24@bandit:/tmp/tmp.tgFt3ekfvA$ cat list.txt |head -n 5000| nc localhost 30002 &gt; output.txt
</span></span><span style=display:flex><span>bandit24@bandit:/tmp/tmp.tgFt3ekfvA$ cat list.txt |tail -n 5000| nc localhost 30002 &gt; tail_output.txt</span></span></code></pre></div></div><p>This produced the flag for bandit25:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit24@bandit:/tmp/tmp.tgFt3ekfvA$ grep -v Wrong *output.txt
</span></span><span style=display:flex><span>output.txt:I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
</span></span><span style=display:flex><span>output.txt:Timeout. Exiting.
</span></span><span style=display:flex><span>tail_output.txt:I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
</span></span><span style=display:flex><span>tail_output.txt:Correct!
</span></span><span style=display:flex><span>tail_output.txt:The password of user bandit25 is p7TaowMYrmu23Ol8hiZh9UvD0O9hpx8d
</span></span><span style=display:flex><span>tail_output.txt:
</span></span><span style=display:flex><span>tail_output.txt:Exiting.</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-79 class=outline-3><h3 id=headline-79>Level 25 → 26</h3><div id=outline-text-headline-79 class=outline-text-3><div id=outline-container-headline-80 class=outline-4><h4 id=headline-80>Level Goal</h4><div id=outline-text-headline-80 class=outline-text-4><p>We are given what looks like a private sshkey for bandit26, but told that the shell for bandit26 is not <em><em>bin/bash</em></em>.</p></div></div><div id=outline-container-headline-81 class=outline-4><h4 id=headline-81>Solution</h4><div id=outline-text-headline-81 class=outline-text-4><p>When trying to login my the bandit25 session failed, so trying from outside.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>-----BEGIN RSA PRIVATE KEY-----
</span></span><span style=display:flex><span>MIIEpQIBAAKCAQEApis2AuoooEqeYWamtwX2k5z9uU1Afl2F8VyXQqbv/LTrIwdW
</span></span><span style=display:flex><span>pTfaeRHXzr0Y0a5Oe3GB/+W2+PReif+bPZlzTY1XFwpk+DiHk1kmL0moEW8HJuT9
</span></span><span style=display:flex><span>/5XbnpjSzn0eEAfFax2OcopjrzVqdBJQerkj0puv3UXY07AskgkyD5XepwGAlJOG
</span></span><span style=display:flex><span>xZsMq1oZqQ0W29aBtfykuGie2bxroRjuAPrYM4o3MMmtlNE5fC4G9Ihq0eq73MDi
</span></span><span style=display:flex><span>1ze6d2jIGce873qxn308BA2qhRPJNEbnPev5gI+5tU+UxebW8KLbk0EhoXB953Ix
</span></span><span style=display:flex><span>3lgOIrT9Y6skRjsMSFmC6WN/O7ovu8QzGqxdywIDAQABAoIBAAaXoETtVT9GtpHW
</span></span><span style=display:flex><span>qLaKHgYtLEO1tOFOhInWyolyZgL4inuRRva3CIvVEWK6TcnDyIlNL4MfcerehwGi
</span></span><span style=display:flex><span>il4fQFvLR7E6UFcopvhJiSJHIcvPQ9FfNFR3dYcNOQ/IFvE73bEqMwSISPwiel6w
</span></span><span style=display:flex><span>e1DjF3C7jHaS1s9PJfWFN982aublL/yLbJP+ou3ifdljS7QzjWZA8NRiMwmBGPIh
</span></span><span style=display:flex><span>Yq8weR3jIVQl3ndEYxO7Cr/wXXebZwlP6CPZb67rBy0jg+366mxQbDZIwZYEaUME
</span></span><span style=display:flex><span>zY5izFclr/kKj4s7NTRkC76Yx+rTNP5+BX+JT+rgz5aoQq8ghMw43NYwxjXym/MX
</span></span><span style=display:flex><span>c8X8g0ECgYEA1crBUAR1gSkM+5mGjjoFLJKrFP+IhUHFh25qGI4Dcxxh1f3M53le
</span></span><span style=display:flex><span>wF1rkp5SJnHRFm9IW3gM1JoF0PQxI5aXHRGHphwPeKnsQ/xQBRWCeYpqTme9amJV
</span></span><span style=display:flex><span>tD3aDHkpIhYxkNxqol5gDCAt6tdFSxqPaNfdfsfaAOXiKGrQESUjIBcCgYEAxvmI
</span></span><span style=display:flex><span>2ROJsBXaiM4Iyg9hUpjZIn8TW2UlH76pojFG6/KBd1NcnW3fu0ZUU790wAu7QbbU
</span></span><span style=display:flex><span>i7pieeqCqSYcZsmkhnOvbdx54A6NNCR2btc+si6pDOe1jdsGdXISDRHFb9QxjZCj
</span></span><span style=display:flex><span>6xzWMNvb5n1yUb9w9nfN1PZzATfUsOV+Fy8CbG0CgYEAifkTLwfhqZyLk2huTSWm
</span></span><span style=display:flex><span>pzB0ltWfDpj22MNqVzR3h3d+sHLeJVjPzIe9396rF8KGdNsWsGlWpnJMZKDjgZsz
</span></span><span style=display:flex><span>JQBmMc6UMYRARVP1dIKANN4eY0FSHfEebHcqXLho0mXOUTXe37DWfZza5V9Oify3
</span></span><span style=display:flex><span>JquBd8uUptW1Ue41H4t/ErsCgYEArc5FYtF1QXIlfcDz3oUGz16itUZpgzlb71nd
</span></span><span style=display:flex><span>1cbTm8EupCwWR5I1j+IEQU+JTUQyI1nwWcnKwZI+5kBbKNJUu/mLsRyY/UXYxEZh
</span></span><span style=display:flex><span>ibrNklm94373kV1US/0DlZUDcQba7jz9Yp/C3dT/RlwoIw5mP3UxQCizFspNKOSe
</span></span><span style=display:flex><span>euPeaxUCgYEAntklXwBbokgdDup/u/3ms5Lb/bm22zDOCg2HrlWQCqKEkWkAO6R5
</span></span><span style=display:flex><span>/Wwyqhp/wTl8VXjxWo+W+DmewGdPHGQQ5fFdqgpuQpGUq24YZS8m66v5ANBwd76t
</span></span><span style=display:flex><span>IZdtF5HXs2S5CADTwniUS5mX1HO9l5gUkk+h0cH5JnPtsMCnAUM+BRY=
</span></span><span style=display:flex><span>-----END RSA PRIVATE KEY-----</span></span></code></pre></div></div><p>Trying to execute commands directly with the ssh command also failed.</p><p>Pocking around the password file, <em><em>etc/passwd</em></em>, we can see the shell is set to a strange binary:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit25@bandit:~$ grep bandit26 /etc/passwd
</span></span><span style=display:flex><span>bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext</span></span></code></pre></div></div><p>Running this <em>showtext</em> executable seems to try and read a <em>text.txt</em> file from the local directory. We can see that there is a text.txt in the bandit26 home as well:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit25@bandit:~$ /usr/bin/showtext bandit26.sshkey
</span></span><span style=display:flex><span>more: cannot open /home/bandit25/text.txt: No such file or directory
</span></span><span style=display:flex><span>bandit25@bandit:~$ ls /home/bandit26/
</span></span><span style=display:flex><span>bandit27-do  text.txt
</span></span><span style=display:flex><span>bandit25@bandit:~$ ls -al /home/bandit26/text.txt
</span></span><span style=display:flex><span>-rw-r----- 1 bandit26 bandit26 258 Apr 23 18:04 /home/bandit26/text.txt
</span></span><span style=display:flex><span>bandit25@bandit:~$</span></span></code></pre></div></div><p>Investigating more, the <em>showtext</em> shell is as custom script:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit25@bandit:~$ which /usr/bin/showtext
</span></span><span style=display:flex><span>/usr/bin/showtext
</span></span><span style=display:flex><span>bandit25@bandit:~$ file /usr/bin/showtext
</span></span><span style=display:flex><span>/usr/bin/showtext: POSIX shell script, ASCII text executable
</span></span><span style=display:flex><span>bandit25@bandit:~$ cat /usr/bin/showtext
</span></span><span style=display:flex><span>#!/bin/sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>export TERM=linux
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exec more ~/text.txt
</span></span><span style=display:flex><span>exit 0</span></span></code></pre></div></div><p>I reproduced this by creating my own copy of showtext and executing it via an ssh command, which behaved in a similar way.
It was strange that <strong>more</strong> was being used, rather than <strong>cat</strong>, but I thought it had something to do with where the output was being sent.</p><p>Eventually I ended up looking around for hints… I was onto something here: <strong>more</strong> functions differently when the window is too small for the contents, so you have to force that to happen.
Once you have <strong>more</strong> running interactively, you can get to an editor using the <em>v</em> command.</p><p>Once in the editor, which defaults to vim, you can open <em><em>etc/bandit_pass-bandit26</em></em> to get the password
<em><em>c7GvcKlw9mC7aUQaPx7nwFstuAIBw1o1</em></em> for bandit26.</p></div></div></div></div><div id=outline-container-headline-82 class=outline-3><h3 id=headline-82>Level 26 → 27</h3><div id=outline-text-headline-82 class=outline-text-3><div id=outline-container-headline-83 class=outline-4><h4 id=headline-83>Level Goal</h4><div id=outline-text-headline-83 class=outline-text-4><p>The hint here was simply 'Good job getting a shell! Now hurry and grab the password for bandit27!'</p></div></div><div id=outline-container-headline-84 class=outline-4><h4 id=headline-84>Solution</h4><div id=outline-text-headline-84 class=outline-text-4><p>After having to look for hints online for the last challenge, I realized that I had to think outside of the box and it would take multiple steps:</p><ol><li>Get log into with bandit25 user and ssh key, making sure the window is small enough to force <strong>more</strong> to enter interactive mode:
<img src=/more.png alt=/more.png title=/more.png></li><li>Hitting <em>v</em> opened up vim, which we could then use to trigger a shell by running <em>:term bash</em>.</li><li><p>Running <strong>ls</strong> in the terminal shows that we have a <em>bandit27-do</em> binary which runs with the bandit27 permissions. We can use this to get the flag for bandit27:
<img src=/shell.png alt=/shell.png title=/shell.png></p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27
</span></span><span style=display:flex><span>YnQpBuifNMas1hcUFk70ZmqkhUU2EuaS</span></span></code></pre></div></div></li></ol></div></div></div></div><div id=outline-container-headline-85 class=outline-3><h3 id=headline-85>Level 27 → 28</h3><div id=outline-text-headline-85 class=outline-text-3><div id=outline-container-headline-86 class=outline-4><h4 id=headline-86>Level Goal</h4><div id=outline-text-headline-86 class=outline-text-4><p>For this we are given the details of a git repository:</p><ul><li>Hosted at ssh://bandit27-git@localhost/home/bandit27-git/repo</li><li>port 2220</li><li>The password for the user bandit27-git is the same as for the user bandit27.</li></ul></div></div><div id=outline-container-headline-87 class=outline-4><h4 id=headline-87>Solution</h4><div id=outline-text-headline-87 class=outline-text-4><p>Pulling down the repo with <strong>git clone</strong>:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ git clone ssh://bandit27-git@bandit.labs.overthewire.org:2220/home/bandit27-git/repo</span></span></code></pre></div></div><p>Within the repo is a single <em>README</em> file which contains the flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ cat README
</span></span><span style=display:flex><span>The password to the next level is: AVanL161y9rsbcJIsFHuw35rjaOM19nR</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-88 class=outline-3><h3 id=headline-88>Level 28 → 29</h3><div id=outline-text-headline-88 class=outline-text-3><div id=outline-container-headline-89 class=outline-4><h4 id=headline-89>Level Goal</h4><div id=outline-text-headline-89 class=outline-text-4><p>Like the previous level, we are given the details of a git repository:</p><ul><li>Hosted at ssh://bandit28-git@localhost/home/bandit28-git/repo</li><li>port 2220</li><li>The password for the user bandit28-git is the same as for the user bandit28.</li></ul></div></div><div id=outline-container-headline-90 class=outline-4><h4 id=headline-90>Solution</h4><div id=outline-text-headline-90 class=outline-text-4><p>Pulling down the repo with <strong>git clone</strong>, we see a single file again, but it doesn't contain the password.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ cat README.md
</span></span><span style=display:flex><span># Bandit Notes
</span></span><span style=display:flex><span>Some notes for level29 of bandit.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## credentials
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- username: bandit29
</span></span><span style=display:flex><span>- password: xxxxxxxxxx</span></span></code></pre></div></div><p>Looking into the git log, we see that a change was made with the commit message of 'fix info leak':</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level29/repo$ git log
</span></span><span style=display:flex><span>commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -&gt; master, origin/master, origin/HEAD)
</span></span><span style=display:flex><span>Author: Morla Porla &lt;morla@overthewire.org&gt;
</span></span><span style=display:flex><span>Date:   Sun Apr 23 18:04:39 2023 +0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    fix info leak
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit abcff758fa6343a0d002a1c0add1ad8c71b88534
</span></span><span style=display:flex><span>Author: Morla Porla &lt;morla@overthewire.org&gt;
</span></span><span style=display:flex><span>Date:   Sun Apr 23 18:04:39 2023 +0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    add missing data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit c0a8c3cf093fba65f4ee0e1fe2a530b799508c78
</span></span><span style=display:flex><span>Author: Ben Dover &lt;noone@overthewire.org&gt;
</span></span><span style=display:flex><span>Date:   Sun Apr 23 18:04:39 2023 +0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    initial commit of README.md
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level29/repo$ git show 899ba88df296331cc01f30d022c006775d467f28
</span></span><span style=display:flex><span>commit 899ba88df296331cc01f30d022c006775d467f28 (HEAD -&gt; master, origin/master, origin/HEAD)
</span></span><span style=display:flex><span>Author: Morla Porla &lt;morla@overthewire.org&gt;
</span></span><span style=display:flex><span>Date:   Sun Apr 23 18:04:39 2023 +0000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    fix info leak
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>diff --git a/README.md b/README.md
</span></span><span style=display:flex><span>index b302105..5c6457b 100644
</span></span><span style=display:flex><span>--- a/README.md
</span></span><span style=display:flex><span>+++ b/README.md
</span></span><span style=display:flex><span>@@ -4,5 +4,5 @@ Some notes for level29 of bandit.
</span></span><span style=display:flex><span> ## credentials
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> - username: bandit29
</span></span><span style=display:flex><span>-- password: tQKvmcwNYcFS6vmPHIUSI3ShmsrQZK8S
</span></span><span style=display:flex><span>+- password: xxxxxxxxxx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level29/repo$</span></span></code></pre></div></div><p>From this we can see the flag was removed in that commit.</p></div></div></div></div><div id=outline-container-headline-91 class=outline-3><h3 id=headline-91>Level 29 → 30</h3><div id=outline-text-headline-91 class=outline-text-3><div id=outline-container-headline-92 class=outline-4><h4 id=headline-92>Level Goal</h4><div id=outline-text-headline-92 class=outline-text-4><p>Like the previous level, we are given the details of a git repository:</p><ul><li>Hosted at ssh://bandit29-git@localhost/home/bandit29-git/repo</li><li>port 2220</li><li>The password for the user bandit29-git is the same as for the user bandit29.</li></ul></div></div><div id=outline-container-headline-93 class=outline-4><h4 id=headline-93>Solution</h4><div id=outline-text-headline-93 class=outline-text-4><p>Pulling down the repo with <strong>git clone</strong>, we see a single file again, but it doesn't contain the password.</p><p>After checking for remote branches, we find a dev branch which contains the flag we are looking for:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level30/repo$ ls
</span></span><span style=display:flex><span>README.md
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level30/repo$ git branch -r
</span></span><span style=display:flex><span>  origin/HEAD -&gt; origin/master
</span></span><span style=display:flex><span>  origin/dev
</span></span><span style=display:flex><span>  origin/master
</span></span><span style=display:flex><span>  origin/sploits-dev
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level30/repo$ git checkout origin/dev
</span></span><span style=display:flex><span>Note: switching to &#39;origin/dev&#39;.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You are in &#39;detached HEAD&#39; state. You can look around, make experimental
</span></span><span style=display:flex><span>changes and commit them, and you can discard any commits you make in this
</span></span><span style=display:flex><span>state without impacting any branches by switching back to a branch.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If you want to create a new branch to retain commits you create, you may
</span></span><span style=display:flex><span>do so (now or later) by using -c with the switch command. Example:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  git switch -c &lt;new-branch-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Or undo this operation with:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  git switch -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Turn off this advice by setting config variable advice.detachedHead to false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>HEAD is now at 13e7356 add data needed for development
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level30/repo$ ls
</span></span><span style=display:flex><span>code  README.md
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level30/repo$ cat README.md
</span></span><span style=display:flex><span># Bandit Notes
</span></span><span style=display:flex><span>Some notes for bandit30 of bandit.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>## credentials
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>- username: bandit30
</span></span><span style=display:flex><span>- password: xbhV3HpNGlTIdnjUrdAlPzc2L6y9EOnS</span></span></code></pre></div></div></div></div></div></div><div id=outline-container-headline-94 class=outline-3><h3 id=headline-94>Level 30 → 31</h3><div id=outline-text-headline-94 class=outline-text-3><div id=outline-container-headline-95 class=outline-4><h4 id=headline-95>Level Goal</h4><div id=outline-text-headline-95 class=outline-text-4><p>Like the previous level, we are given the details of a git repository:</p><ul><li>Hosted at ssh://bandit30-git@localhost/home/bandit30-git/repo</li><li>port 2220</li><li>The password for the user bandit30-git is the same as for the user bandit30.</li></ul></div></div><div id=outline-container-headline-96 class=outline-4><h4 id=headline-96>Solution</h4><div id=outline-text-headline-96 class=outline-text-4><p>Pulling down the repo with <strong>git clone</strong>, we see a single file again, but it doesn't contain the password.</p><p>The repo seems to have only a single remote branch, but running the <em>git ls-remote</em> command returns a reference to a secret tag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo$ git branch -r
</span></span><span style=display:flex><span>  origin/HEAD -&gt; origin/master
</span></span><span style=display:flex><span>  origin/master
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo$ git ls-remote
</span></span><span style=display:flex><span>                         _                     _ _ _
</span></span><span style=display:flex><span>                        | |__   __ _ _ __   __| (_) |_
</span></span><span style=display:flex><span>                        | &#39;_ \ / _` | &#39;_ \ / _` | | __|
</span></span><span style=display:flex><span>                        | |_) | (_| | | | | (_| | | |_
</span></span><span style=display:flex><span>                        |_.__/ \__,_|_| |_|\__,_|_|\__|
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                      This is an OverTheWire game server.
</span></span><span style=display:flex><span>            More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit30-git@bandit.labs.overthewire.org&#39;s password:
</span></span><span style=display:flex><span>From ssh://bandit30-git@bandit.labs.overthewire.org:2220/home/bandit30-git/repo
</span></span><span style=display:flex><span>59530d30d299ff2e3e9719c096ebf46a65cc1424	HEAD
</span></span><span style=display:flex><span>59530d30d299ff2e3e9719c096ebf46a65cc1424	refs/heads/master
</span></span><span style=display:flex><span>831aac2e2341f009e40e46392a4f5dd318483019	refs/tags/secret
</span></span><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo$</span></span></code></pre></div></div><p>I am sure there is a better way of doing this, but when trying to checkout the tag, an error was returned suggesting the commit wasn't part of the same branch.</p><p>After poking around, found some information on the <strong>git unpack-objects</strong> command, thanks to <a href=https://stackoverflow.com/questions/3333255/how-to-unpack-packed-refs>stack overflow</a>. I then looked at how to decompress the unpacked objects, with the help of <a href=https://matthew-brett.github.io/curious-git/reading_git_objects.html>this tutorial</a>.</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo$ cat pack-ce041ba8ee175c320e2f90422d56c0a25e6d6b86.pack | git unpack-objects</span></span></code></pre></div></div><p>which produced a number of object files where the pack file used to be:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo/.git/objects$ tree
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── 02
</span></span><span style=display:flex><span>│   └── 9ba421ef4c34205d52133f8da3d69bc1853777
</span></span><span style=display:flex><span>├── 59
</span></span><span style=display:flex><span>│   └── 530d30d299ff2e3e9719c096ebf46a65cc1424
</span></span><span style=display:flex><span>├── 83
</span></span><span style=display:flex><span>│   └── 1aac2e2341f009e40e46392a4f5dd318483019
</span></span><span style=display:flex><span>├── bd
</span></span><span style=display:flex><span>│   └── 85592e905590f084b8df33363a46f9ac4aa708
</span></span><span style=display:flex><span>├── info
</span></span><span style=display:flex><span>└── pack
</span></span><span style=display:flex><span>    └── pack-ce041ba8ee175c320e2f90422d56c0a25e6d6b86.idx</span></span></code></pre></div></div><p>Then using a python shell to inspect the objects:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level31/repo/.git/objects/83$ python3
</span></span><span style=display:flex><span>Python 3.10.6 (main, Mar 10 2023, 10:55:28) [GCC 11.3.0] on linux
</span></span><span style=display:flex><span>Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
</span></span><span style=display:flex><span>&gt;&gt;&gt; import zlib
</span></span><span style=display:flex><span>&gt;&gt;&gt; filename = &#39;1aac2e2341f009e40e46392a4f5dd318483019&#39;
</span></span><span style=display:flex><span>&gt;&gt;&gt; compressed_contents = open(filename, &#39;rb&#39;).read()
</span></span><span style=display:flex><span>&gt;&gt;&gt; decompressed_contents = zlib.decompress(compressed_contents)
</span></span><span style=display:flex><span>&gt;&gt;&gt; decompressed_contents
</span></span><span style=display:flex><span>b&#39;blob 33\x00OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt\n&#39;
</span></span><span style=display:flex><span>&gt;&gt;&gt; exit()</span></span></code></pre></div></div><p>Our flag is in the decompressed contents variable with the value of <em>OoffzGDlzhAlerFJ2cAiz1D41JW1Mhmt</em>.</p></div></div></div></div><div id=outline-container-headline-97 class=outline-3><h3 id=headline-97>Level 31 → 32</h3><div id=outline-text-headline-97 class=outline-text-3><div id=outline-container-headline-98 class=outline-4><h4 id=headline-98>Level Goal</h4><div id=outline-text-headline-98 class=outline-text-4><p>Like the previous level, we are given the details of a git repository:</p><ul><li>Hosted at ssh://bandit31-git@localhost/home/bandit31-git/repo</li><li>port 2220</li><li>The password for the user bandit31-git is the same as for the user bandit30.</li></ul></div></div><div id=outline-container-headline-99 class=outline-4><h4 id=headline-99>Solution</h4><div id=outline-text-headline-99 class=outline-text-4><p>This one was relatively simple, with the instructions being to commit a key file:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level32/repo$ cat README.md
</span></span><span style=display:flex><span>This time your task is to push a file to the remote repository.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Details:
</span></span><span style=display:flex><span>    File name: key.txt
</span></span><span style=display:flex><span>    Content: &#39;May I come in?&#39;
</span></span><span style=display:flex><span>    Branch: master</span></span></code></pre></div></div><p>After adding the file and attempting to push the change, a message is returned with the next flag:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>user@system76-pc:~/workspace/overTheWire/bandit/level32/repo$ git push
</span></span><span style=display:flex><span>                         _                     _ _ _
</span></span><span style=display:flex><span>                        | |__   __ _ _ __   __| (_) |_
</span></span><span style=display:flex><span>                        | &#39;_ \ / _` | &#39;_ \ / _` | | __|
</span></span><span style=display:flex><span>                        | |_) | (_| | | | | (_| | | |_
</span></span><span style=display:flex><span>                        |_.__/ \__,_|_| |_|\__,_|_|\__|
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                      This is an OverTheWire game server.
</span></span><span style=display:flex><span>            More information on http://www.overthewire.org/wargames
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bandit31-git@bandit.labs.overthewire.org&#39;s password:
</span></span><span style=display:flex><span>Enumerating objects: 4, done.
</span></span><span style=display:flex><span>Counting objects: 100% (4/4), done.
</span></span><span style=display:flex><span>Delta compression using up to 12 threads
</span></span><span style=display:flex><span>Compressing objects: 100% (2/2), done.
</span></span><span style=display:flex><span>Writing objects: 100% (3/3), 343 bytes | 343.00 KiB/s, done.
</span></span><span style=display:flex><span>Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
</span></span><span style=display:flex><span>remote: ### Attempting to validate files... ####
</span></span><span style=display:flex><span>remote:
</span></span><span style=display:flex><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span></span><span style=display:flex><span>remote:
</span></span><span style=display:flex><span>remote: Well done! Here is the password for the next level:
</span></span><span style=display:flex><span>remote: rmCBvG56y58BXzv98yZGdO7ATVL5dW8y
</span></span><span style=display:flex><span>remote:
</span></span><span style=display:flex><span>remote: .oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.oOo.
</span></span><span style=display:flex><span>remote:
</span></span><span style=display:flex><span>To ssh://bandit.labs.overthewire.org:2220/home/bandit31-git/repo
</span></span><span style=display:flex><span> ! [remote rejected] master -&gt; master (pre-receive hook declined)
</span></span><span style=display:flex><span>error: failed to push some refs to &#39;ssh://bandit.labs.overthewire.org:2220/home/bandit31-git/repo&#39;</span></span></code></pre></div></div><p>The flag returned is <em>rmCBvG56y58BXzv98yZGdO7ATVL5dW8y</em>.</p></div></div></div></div><div id=outline-container-headline-100 class=outline-3><h3 id=headline-100>Level 32 → 33</h3><div id=outline-text-headline-100 class=outline-text-3><div id=outline-container-headline-101 class=outline-4><h4 id=headline-101>Level Goal</h4><div id=outline-text-headline-101 class=outline-text-4><p>We are given very little to go on, besides needing to escape.</p></div></div><div id=outline-container-headline-102 class=outline-4><h4 id=headline-102>Solution</h4><div id=outline-text-headline-102 class=outline-text-4><ul><li><p>When logging in we are presented with the MOTD and a welcome message</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>WELCOME TO THE UPPERCASE SHELL
</span></span><span style=display:flex><span>&gt;&gt; ls
</span></span><span style=display:flex><span>sh: 1: LS: not found
</span></span><span style=display:flex><span>&gt;&gt; help
</span></span><span style=display:flex><span>sh: 1: HELP: not found
</span></span><span style=display:flex><span>&gt;&gt; l
</span></span><span style=display:flex><span>sh: 1: L: not found</span></span></code></pre></div></div></li><li><p>Used <em>bandit30</em> to have a look at what the shell is for <em>bandit32</em></p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit30@bandit:~$ grep bandit32 /etc/passwd
</span></span><span style=display:flex><span>bandit32:x:11032:11032:bandit level 32:/home/bandit32:/home/bandit32/uppershell
</span></span><span style=display:flex><span>bandit30@bandit:~$ ls -alt /home/bandit32/
</span></span><span style=display:flex><span>total 36
</span></span><span style=display:flex><span>drwxr-xr-x 70 root     root      4096 Apr 23 18:05 ..
</span></span><span style=display:flex><span>drwxr-xr-x  2 root     root      4096 Apr 23 18:04 .
</span></span><span style=display:flex><span>-rwsr-x---  1 bandit33 bandit32 15128 Apr 23 18:04 uppershell
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root       220 Jan  6  2022 .bash_logout
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root      3771 Jan  6  2022 .bashrc
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root       807 Jan  6  2022 .profile
</span></span><span style=display:flex><span>bandit30@bandit:~$</span></span></code></pre></div></div><p>We do see that owner seems to be bandit33, which provides a good hint about this being something we need to break out of or possible cause to crash.</p></li><li><p>I got something to at least run by trying calling the $PATH environment variable:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>&gt;&gt; $PATH
</span></span><span style=display:flex><span>sh: 1: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin: not found
</span></span><span style=display:flex><span>&gt;&gt;</span></span></code></pre></div></div></li></ul><p>Using <strong>print</strong>, we can check the list of possible environment variable, when called, causing value of the variable to be called.</p><ul><li>After digging around, this seems to be a dash shell, which has some features to let you play with environment variables by removing matching prefixes and suffixes. See <a href=http://eriklievaart.com/cheat/linux/shell/dash/dash.html>Erick's Cheat Sheet</a></li><li>Could get a shell to be run, such as <em>/bin/bash</em> or even <em>sh</em>, or for the password to be provided to us, which is in <em>cat /etc/bandit_pass/bandit33</em></li><li>Either approach is going to require some manipulation of env variables. <a href=https://www.secjuice.com/bypass-strict-input-validation-with-remove-suffix-and-prefix-pattern/>This guide</a> also provided a lot of insight into what we could do here.</li><li><p>Using the ? wildcard, we can remove characters from the left and right side of terminal variables, and get these to be run as commands:</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>&gt;&gt; ${PWD}
</span></span><span style=display:flex><span>sh: 1: /home/bandit32: Permission denied
</span></span><span style=display:flex><span>&gt;&gt; ${PWD%???}
</span></span><span style=display:flex><span>sh: 1: /home/bandi: not found
</span></span><span style=display:flex><span>&gt;&gt; ${PWD#???}
</span></span><span style=display:flex><span>sh: 1: me/bandit32: not found
</span></span><span style=display:flex><span>&gt;&gt;</span></span></code></pre></div></div><ul><li><p>Just as I was about to hit my head into the desk, I went on the hunt for more variables to play with when this happened!</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>&gt;&gt; $0
</span></span><span style=display:flex><span>$ ls
</span></span><span style=display:flex><span>uppershell
</span></span><span style=display:flex><span>$ ls -alt
</span></span><span style=display:flex><span>total 36
</span></span><span style=display:flex><span>drwxr-xr-x 70 root     root      4096 Apr 23 18:05 ..
</span></span><span style=display:flex><span>drwxr-xr-x  2 root     root      4096 Apr 23 18:04 .
</span></span><span style=display:flex><span>-rwsr-x---  1 bandit33 bandit32 15128 Apr 23 18:04 uppershell
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root       220 Jan  6  2022 .bash_logout
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root      3771 Jan  6  2022 .bashrc
</span></span><span style=display:flex><span>-rw-r--r--  1 root     root       807 Jan  6  2022 .profile
</span></span><span style=display:flex><span>$</span></span></code></pre></div></div><p>And that let us get the final flag!</p><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ cat /etc/bandit_pass/bandit33
</span></span><span style=display:flex><span>odHo63fHiFqcWWJG9rLiLDtPm45KzUKy</span></span></code></pre></div></div></li></ul></li></ul></div></div></div></div><div id=outline-container-headline-103 class=outline-3><h3 id=headline-103>Level 33</h3><div id=outline-text-headline-103 class=outline-text-3><div class="src src-text"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>bandit33@bandit:~$ cat README.txt
</span></span><span style=display:flex><span>Congratulations on solving the last level of this game!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>At this moment, there are no more levels to play in this game. However, we are constantly working
</span></span><span style=display:flex><span>on new levels and will most likely expand this game with more levels soon.
</span></span><span style=display:flex><span>Keep an eye out for an announcement on our usual communication channels!
</span></span><span style=display:flex><span>In the meantime, you could play some of our other wargames.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>If you have an idea for an awesome new level, please let us know!</span></span></code></pre></div></div></div></div></section><nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]"><a class="flex w-1/2 items-center rounded-l-md p-6 pr-3 no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]" href=https://codeinpublic.dev/posts/hello-world/><span class=mr-1.5>←</span><span>Hello World</span></a></nav></article></main><footer class="opaco mx-auto flex h-[5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"><div class=mr-auto>&copy; 2023
<a class=link href=https://codeinpublic.dev/>Code in public</a></div><a class="link mx-6" href=https://gohugo.io/ rel=noopener target=_blank>Powered by Hugo️️</a>️
<a class=link href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Theme Paper</a></footer></body></html>